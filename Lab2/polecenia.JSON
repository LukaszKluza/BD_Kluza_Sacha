db.tours.find(
{
    "company.name": "City Explorations Inc.",
    "person.name": "William Davis",
    "reservation.price": {$gt: 130},
    "tour.duration": {$eq: 4},
},
{
    "_id":0,
    "person.name": 1,
    "tour.name": 1,
    "tour.duration": 1,
    "company.name": 1,
    "reservation.seats" :1,
    "reservation.price" :1,
}
)

db.persons.aggregate([
    {
        $lookup: {
            from: "reservations",
            localField: "_id",
            foreignField: "personId",
            as: "reservation"
        }
    },
    {$unwind: "$reservation"},
    {
        $lookup: {
            from: "tours",
            localField: "reservation.tourId",
            foreignField: "_id",
            as: "tour"
        }
    },
    {$unwind: "$tour"},
    {
        $lookup: {
            from: "companies",
            localField: "tour.companyId",
            foreignField: "_id",
            as: "company"
        }
    },
    { $unwind: "$company" },
    { $match: { "name": "Sophia Taylor" } },
    { $match: { "company.name": "Adventures Unlimited LLC" } },
    { $match: { "reservation.price": { $gt: 75 } } },
    { $match: { "tour.duration": 5 } },
    {
        $project: { "_id": 0, "name": 1, "tour.name": 1, "tour.duration": 1, "company.name": 1, "reservation.seats" :1, "reservation.price" :1}
    }
])

db.tours.aggregate([
  {
    $group: {
      _id: "$person.name",
    }
  }
])

db.persons.distinct("name")

db.tours.insertOne(
  {
    "company": {
      "name": "Adventure Seekers Ltd.",
      "location": "Denver"
    },
    "tour": {
      "name": "Mountain Hiking Expedition",
      "date": new Date("2025-07-15T08:00:00Z"),
      "duration": 5
    },
    "person": {
      "name": "David Johnson",
      "email": "david@example.com"
    },
    "reservation": {
      "seats": 2,
      "price": 120,
    },
    "rating": 4
  },
)

db.companies.insertOne({
    "name": "Adventure Seekers Ltd.",
    "location": "Denver"
})

db.persons.insertOne({
    "name": "David Johnson",
    "email": "david@example.com"
})

db.tours.insertOne({
    "companyId" : ObjectId("66375ff0bbce22392efc686c"),
    "name": "Mountain Hiking Expedition",
    "date": new Date("2025-07-15T08:00:00Z"),
    "duration": 5
})

db.reservations.insertOne({
    "tourId": ObjectId("6637639fbbce22392efc6872"),
    "personId": ObjectId("663760f1bbce22392efc686e"),
    "seats": 2,
    "price": 120,
    "rating": 4
})


db.tours.deleteOne({
    _id : ObjectId("66375bf1bbce22392efc686a")
})


db.companies.deleteOne({
    _id : ObjectId("66375ff0bbce22392efc686c")
})
db.persons.deleteOne({
    _id : ObjectId("663760f1bbce22392efc686e")
})
db.tours.deleteOne({
    _id : ObjectId("6637639fbbce22392efc6872")
})
db.reservations.deleteOne({
    _id : ObjectId("6637659ebbce22392efc6874")
})

db.tours.updateMany(
    {
        "company.name" : "City Tours Inc."
    },
    {
        $set: {"company.location" : "New York"}
    }
)

db.companies.updateOne(
    {
        "name" : "City Tours Inc."
    },
    {
        $set: {"location" : "New York"}
    }
)
